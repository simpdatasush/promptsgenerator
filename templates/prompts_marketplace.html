<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>SuperPrompter - Prompts Marketplace</title>
   <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
   <link rel="icon" type="image/png" href="{{ url_for('static', filename='favicon.png') }}">
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='favicon.png') }}">
   
   <style>
       :root {
    --color-primary: #007bff;     /* Landing Page Blue */
    --color-dark-bg: #343a40;     /* Landing Page Charcoal */
    --color-accent: #C3497C;      /* Keeping Pink ONLY for AI Summary */
    --color-bg-light: #f0f2f5;
    --color-text-dark: #2c3e50;
    --shadow-standard: 0 4px 15px rgba(0, 0, 0, 0.1);
    --radius-standard: 10px;
}

*, *::before, *::after { box-sizing: border-box; }

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0;
    padding-top: 100px; /* Unified gap for fixed header */
    background-color: var(--color-bg-light);
    color: var(--color-text-dark);
    line-height: 1.6;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
}

/* =========================================
   2. UNIFIED HEADER (Stable on all pages)
========================================= */
.app-header {
    background-color: var(--color-dark-bg);
    color: #ffffff;
    padding: 15px 30px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    width: 100%;
    position: fixed;
    top: 0;
    left: 0;
    z-index: 1000;
}

.app-header .logo-section { display: flex; align-items: center; }
.app-header .app-logo { height: 40px; margin-right: 15px; border-radius: 5px; }

.app-header h1.header-title {
            margin: 0;
            font-size: 1.8rem;
            color: #ffffff;
            text-align: left;
        }

.app-header .auth-section { display: flex; align-items: center; }
.app-header .auth-section a {
    color: #ffffff;
    margin-left: 20px;
    text-decoration: none;
    transition: color 0.2s ease;
    white-space: nowrap;
}

.app-header .auth-section a:hover { color: var(--color-primary); }

      * Target the container and the link specifically */
.nav-section a {
    color: #ffffff !important; /* Forces the color to white */
    text-decoration: none;
    font-weight: 500;
    transition: color 0.2s ease;
}

/* --- Global Marketplace Variables --- */
:root {
    --color-primary: #007bff;
    --color-primary-dark: #0056b3;
    --color-accent: #e83e8c;
    --color-success: #28a745;
    --color-text-main: #1e293b;
    --color-text-muted: #64748b;
    --shadow-standard: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --shadow-premium: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
}

/* --- Marketplace Grid --- */
.brick-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 25px;
    margin-bottom: 50px;
    padding: 10px;
}

/* --- Premium Card Base --- */
.prompt-card {
    background: #ffffff;
    border: 1px solid #eef2f7;
    border-radius: 16px;
    padding: 24px;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    flex-direction: column;
    min-height: 320px;
    position: relative;
    overflow: hidden;
    box-shadow: var(--shadow-standard);
}

.prompt-card:hover {
    transform: translateY(-8px);
    border-color: var(--color-primary);
    box-shadow: var(--shadow-premium);
}

/* --- Header & Masked User ID --- */
.masked-user-id {
    font-weight: 700;
    color: var(--color-text-muted);
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.8px;
    display: flex;
    align-items: center;
    gap: 6px;
}

.badge-soft-primary {
    background-color: #ebf5ff;
    color: #007bff;
    font-size: 0.75rem;
    font-weight: 600;
    padding: 5px 12px;
    border-radius: 20px;
}

/* --- Prompt Subject (Title) --- */
.prompt-subject {
    font-weight: 800;
    color: var(--color-text-main);
    margin: 15px 0 10px 0;
    font-size: 1.25rem;
    line-height: 1.3;
}

/* --- Prompt Text Content --- */
.prompt-text-area {
    background: #f8fafc;
    padding: 15px;
    border-radius: 10px;
    font-size: 0.9rem;
    margin: 10px 0;
    border-left: 4px solid var(--color-primary);
    white-space: pre-wrap;
    color: #334155;
    max-height: 120px;
    overflow-y: auto;
    position: relative;
}

/* --- Premium Lock & Blur Logic --- */
.content-blurred {
    filter: blur(8px);
    user-select: none;
    pointer-events: none;
    opacity: 0.4;
}

.lock-overlay {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
    z-index: 10;
    width: 90%;
}

.lock-overlay i {
    font-size: 2rem;
    color: #475569;
    margin-bottom: 8px;
}

/* --- Engagement & Social Bar --- */
.engagement-bar {
    background: #f1f5f9;
    padding: 8px 15px;
    border-radius: 30px;
    margin: 15px 0;
    border: 1px solid #e2e8f0;
}

.social-stat {
    cursor: pointer;
    font-weight: 600;
    color: var(--color-text-muted);
    transition: transform 0.2s ease;
}

.social-stat:hover {
    transform: scale(1.1);
}

.share-group a {
    color: #94a3b8;
    font-size: 1rem;
    transition: color 0.2s;
}

.share-group a:hover {
    color: var(--color-text-main);
}

/* --- Premium Buttons --- */
.btn-copy-premium {
    background: transparent;
    border: 2px solid var(--color-success);
    color: var(--color-success);
    font-weight: 700;
    border-radius: 10px;
    padding: 10px;
    transition: all 0.2s;
}

.btn-copy-premium:hover {
    background: var(--color-success);
    color: #ffffff;
}

.btn-primary-premium {
    background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
    color: #ffffff;
    border: none;
    font-weight: 700;
    border-radius: 10px;
    padding: 10px;
    box-shadow: 0 4px 10px rgba(79, 70, 229, 0.3);
}

.btn-primary-premium:hover {
    background: linear-gradient(135deg, #4f46e5 0%, #4338ca 100%);
    color: white;
    box-shadow: 0 6px 15px rgba(79, 70, 229, 0.4);
}

.llm-shortcuts .btn {
    font-size: 0.75rem;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 4px;
    transition: all 0.2s;
}

.llm-shortcuts .btn:hover {
    background-color: #f8fafc;
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

/* Color icons for branding */
.fa-robot { color: #10a37f; } /* ChatGPT Green */
.fa-stars { color: #4285f4; } /* Gemini Blue */

/* --- Category Headers --- */
.category-header {
    font-weight: 800;
    color: #1e293b;
    border-left: 5px solid var(--color-primary);
    padding-left: 15px;
    margin: 40px 0 20px 0;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.footer {
           padding: 20px;
           text-align: center;
           font-size: 0.85rem;
           background-color: #ffffff;
           border-top: 1px solid #dee2e6;
           margin-top: auto;
       }
/* --- Modern Alphabet Navigation --- */
.alphabet-nav {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
    margin-bottom: 40px;
    padding: 10px;
}

.letter-btn {
    background: #ffffff;
    color: #475569;
    border: 1px solid #e2e8f0;
    width: 44px;
    height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 12px; /* Smooth rounded corners */
    font-weight: 700;
    font-size: 0.95rem;
    cursor: pointer;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
}

/* Specific styling for 'ALL' and '#' buttons */
.letter-btn:first-child, 
.letter-btn:last-child {
    width: auto;
    padding: 0 18px;
    text-transform: uppercase;
}

.letter-btn:hover {
    background: #f8fafc;
    border-color: #cbd5e1;
    transform: translateY(-2px);
    color: #2563eb;
}

.letter-btn.active {
    background: #2563eb; /* Primary Branding Blue */
    color: #ffffff;
    border-color: #2563eb;
    box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
}

</style>
</head>
<body>
   <header class="app-header">
        <div class="logo-section">
            <img src="https://placehold.co/40x40/007bff/ffffff?text=AI" alt="SuperPrompter Logo" class="app-logo">
            <h1 class="header-title">SuperPrompter</h1>
       </div>
       <div class="nav-section">
           <a href="/">Home</a>
       </div>
   </header>

   <div class="container">
    <div class="text-center mb-5">
        <h2 class="font-weight-bold">Prompts Marketplace</h2>
        <p class="text-muted">Premium and community prompts to supercharge your AI.</p>
    </div>

    <div class="alphabet-nav d-flex flex-wrap justify-content-center mb-5">
    <button class="letter-btn active" onclick="filterByLetter('ALL', this)">ALL</button>
    {% for char in "ABCDEFGHIJKLMNOPQRSTUVWXYZ" %}
        <button class="letter-btn" onclick="filterByLetter('{{ char }}', this)">{{ char }}</button>
    {% endfor %}
    <button class="letter-btn" onclick="filterByLetter('OTHER', this)">#</button>
</div>

<div id="dynamic-prompts-container">
    </div>

<noscript>
    <div class="brick-grid">
        {% for p in prompts %}
        <div class="prompt-card">
            <h5 class="mb-0">{{ p.title }}</h5>
            <p>{{ p.description[:100] }}...</p>
        </div>
        {% endfor %}
    </div>
</noscript>

<script>
// 1. Data Ingestion from Python/Jinja
const allPrompts = [
    {% for p in prompts %}
    {
        id: "{{ p.id }}",
        // Masked ID: User# and the last 4 digits of the DB ID
        maskedUser: "User#{{ (p.id | string)[-4:] if (p.id | string)|length >= 4 else (p.id | string).zfill(4) }}",
        // Clean Title: Removes "Community:" prefix
        title: "{{ p.title.replace('Community: ', '').replace('User Sub: ', '') }}",
        category: {{ p.description | tojson }}.match(/\[PROMPT\]\[(.*?)\]/) ? {{ p.description | tojson }}.match(/\[PROMPT\]\[(.*?)\]/)[1] : "General",
        visibility: {{ p.description | tojson }}.match(/\[PROMPT\]\[.*?\]\[(.*?)\]/) ? {{ p.description | tojson }}.match(/\[PROMPT\]\[.*?\]\[(.*?)\]/)[1] : "OPEN",
        content: {{ p.description | tojson }}.replace(/\[PROMPT\]\[.*?\]\[.*?\]/, "").trim()
    },
    {% endfor %}
];

// 2. Main Filter & Render Function
function filterByLetter(letter, element) {
    document.querySelectorAll('.letter-btn').forEach(btn => btn.classList.remove('active'));
    if (element) element.classList.add('active');

    const container = document.getElementById('dynamic-prompts-container');
    container.innerHTML = "";

    let matches = (letter === 'ALL') ? allPrompts : 
                  (letter === 'OTHER') ? allPrompts.filter(p => !/^[a-zA-Z]/.test(p.title.trim())) :
                  allPrompts.filter(p => p.title.trim().toUpperCase().startsWith(letter));

    if (matches.length === 0) {
        container.innerHTML = `<div class="text-center py-5 text-muted"><i class="fas fa-search fa-3x mb-3"></i><br>No results for "${letter}"</div>`;
        return;
    }

    const grouped = matches.reduce((acc, p) => {
        acc[p.category] = acc[p.category] || [];
        acc[p.category].push(p);
        return acc;
    }, {});

    for (const [category, prompts] of Object.entries(grouped)) {
        let section = `<h3 class="category-header">${category}</h3><div class="brick-grid">`;
        
        prompts.forEach(p => {
            const isLocked = p.visibility === "LOCKED";
            
            section += `
                <div class="prompt-card premium-style">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <span class="masked-id"><i class="fas fa-user-shield"></i> ${p.maskedUser}</span>
                        <span class="badge badge-pill badge-light border">${category}</span>
                    </div>
                    
                    <h5 class="prompt-title">${p.title}</h5>
                    
                    <div class="prompt-text-area ${isLocked ? 'content-blurred' : ''}" id="prompt-${p.id}">
                        ${isLocked ? "Premium prompt. Support the community to unlock." : p.content}
                    </div>

                    <div class="engagement-bar d-flex align-items-center my-3">
    <button class="btn btn-sm btn-outline-success mr-2" onclick="copyToClipboard('${p.id}', this)">
        <i class="fas fa-copy"></i> Copy Prompt
    </button>
    
    <div class="ml-auto d-flex align-items-center">
        <a href="/donate" class="btn btn-outline-primary btn-sm mr-3">Donate!</a>
        <a href="https://x.com/intent/post?text=${encodeURIComponent('Check out this AI prompt: ' + p.title)}" target="_blank" class="share-link mr-2">
            <i class="fa-brands fa-x-twitter"></i>
        </a>
        <a href="https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(window.location.href)}" target="_blank" class="share-link">
            <i class="fa-brands fa-linkedin"></i>
        </a>
    </div>
</div>

<div class="mt-auto d-flex gap-2">
    ${!isLocked ? `
        <button class="btn btn-primary-premium flex-grow-1 mr-1" onclick="copyAndLaunch('${p.id}', 'https://chatgpt.com', this)">
            <i class="fa-solid fa-robot"></i> ChatGPT
        </button>
        <button class="btn btn-primary-premium flex-grow-1" onclick="copyAndLaunch('${p.id}', 'https://gemini.google.com', this)">
            <i class="fa-solid fa-stars"></i> Gemini
        </button>
    ` : `
        <a href="/donate" class="btn btn-block btn-primary-premium"><i class="fas fa-unlock"></i> Unlock Now</a>
    `}
</div>
</div>`; // End of prompt-card
           
        });
        section += `</div>`;
        container.insertAdjacentHTML('beforeend', section);
    }
}

document.addEventListener("DOMContentLoaded", () => filterByLetter('ALL'));

function copyToClipboard(id, event) {
    const promptData = allPrompts.find(p => String(p.id) === String(id));
    
    if (promptData && promptData.visibility !== "LOCKED") {
        const textToCopy = promptData.content; 
        
        navigator.clipboard.writeText(textToCopy).then(() => {
            // UI Feedback Fix
            const btn = event.currentTarget; 
            const originalHTML = btn.innerHTML;
            
            btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
            btn.classList.add('btn-success');
            
            setTimeout(() => {
                btn.innerHTML = originalHTML;
                btn.classList.remove('btn-success');
            }, 2000);
        });
    }
}

function copyAndLaunch(id, url, event) {
    const promptData = allPrompts.find(p => String(p.id) === String(id));
    
    if (promptData && promptData.visibility !== "LOCKED") {
        navigator.clipboard.writeText(promptData.content).then(() => {
            // Provide visual feedback on the small button
            const btn = event.currentTarget;
            const originalHTML = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-check"></i>';
            
            setTimeout(() => { btn.innerHTML = originalHTML; }, 1000);

            // Open the LLM in a new tab
            window.open(url, '_blank');
        }).catch(() => {
            // Fallback: If clipboard fails, still open the site
            window.open(url, '_blank');
        });
    } else {
        alert("This prompt is locked!");
    }
}

</script>
<footer class="footer">
       <div class="footer-content">
           &copy; 2026 Prompts Marketplace &nbsp; | &nbsp; 
           <a href="mailto:info@promptsgenerator.ai">Contact Support</a>
       </div>
</footer>

</body>
</html>
